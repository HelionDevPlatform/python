<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Python Starter App</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="/client/content/bootstrap.css" rel="stylesheet"/>
    <link href="/client/content/bootstrap-responsive.css" rel="stylesheet"/>
    <link href="/client/content/style.css" rel="stylesheet"/>
    <link href="/client/content/shCore.css" rel="stylesheet"/>
    <link href="/client/content/shThemeDefault.css" rel="stylesheet"/>

    <script src="/client/scripts/modernizr-2.6.2.js"></script>

    <script src="/client/scripts/jquery-1.8.2.js"></script>
    <script src="/client/scripts/jquery-1.9.1.js"></script>

    <script src="/client/scripts/bootstrap.js"></script>
   
   
    <script src="/client/scripts/main.js"></script>
    <script src="/client/scripts/shCore.js"></script>
    <script src="/client/scripts/shBrushXml.js"></script>
    <script src="/client/scripts/shBrushPython.js"></script>
    <!--Font-->
    <link href="http://fonts.googleapis.com/css?family=Source+Sans+Pro:200,300,400,600" rel="stylesheet" type="text/css">
    

</head>
<body>
     <script type="text/javascript">
        SyntaxHighlighter.all();
    </script>
    <div id="header-row">
        <div class="container">
            <div class="row">
                <!--LOGO-->
                <div class="span3"><a class="brand" href="#"><img src="/client/img/HelionLogo.png" style="padding-top:8px"></a></div>
                <!-- /LOGO -->
                <!-- MAIN NAVIGATION -->
                <div class="span9">
                    <div class="navbar  pull-right">
                        <div class="navbar-inner">
                            <a data-target=".navbar-responsive-collapse" data-toggle="collapse" class="btn btn-navbar"><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></a>
                            <div class="nav-collapse collapse navbar-responsive-collapse">
                                <ul class="nav">
                                    <li class="active"><a href="/index.html">Home</a></li>

                                    <li><a href="/addservice.html">Add Services</a></li>

                                </ul>
                            </div>

                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>     
    <!-- MAIN NAVIGATION -->
    <div class="container" style="margin-bottom:30px"> 
        <h2>ALS Services<span style="padding-left:10px;font-size:.6em">(these are built into Cloud Foundry and enabled by your admin)</span></h2>
        <div id="als-service-buttons">

        </div>
        <div class="collapsediv" id="filesystem_div">
            <div class="well on">
                <div class='alert alert-success' role='alert'>This service is enabled and bound to your app.  Use the connection info and code snippets below to use it in your app.</div>
            </div>
            <div class="well off">
                <div class="alert alert-warning" role="alert">This service was not provisioned during the microcloud creation process.  Create this service using the <a href="http://docs.hpcloud.com/#devplatform/1.3/helion/CLI/cfmgmt_growcluster_addservice.html">cf-mgmt tool</a>.</div>
                <p>To create an instance of the filesystem service, execute the  commands below in the directory containing the your app:</p>
                <pre>helion
                    create-service filesystem dotnet-starter-filesystem dotnet-starter
                </pre>
                <p>You can also uncomment the following in the manifest.yml and push the app again.</p>
                <pre>${name}-filesystem:<br />
                    &nbsp;&nbsp;type: filesystem
                </pre>
                <p>After the steps above, deploy the app and refresh this page. </p>
                <pre>helion
                    push --stack win2012r2
                </pre>
            </div>
        </div>
        <div class="collapsediv" id="harbor_div">
            <div class="well on">
                <div class='alert alert-success' role='alert'>This service is enabled and bound to your app.  Use the connection info and code snippets below to use it in your app.</div>
            </div>
            <div class="well off">
                <div class="alert alert-warning" role="alert">This service was not provisioned during the microcloud creation process.  Create this service using the <a href="http://docs.hpcloud.com/#devplatform/1.3/helion/CLI/cfmgmt_growcluster_addservice.html">cf-mgmt tool</a>.</div>
                <p>To create an instance of the harbor port service, execute the  commands below in the directory containing the your app:</p>
                <pre>helion
                    create-service harbor dotnet-starter-harbor dotnet-starter
                </pre>
                <p>You can also uncomment the following in the manifest.yml and push the app again.</p>
                <pre>
                    ${name}-harbor:<br />
                    &nbsp;&nbsp;type: harbor
                </pre>
                <p>After the steps above, deploy the app and refresh this page. </p>
                <pre>helion
                    push --stack win2012r2
                </pre>
            </div>
        </div>
        <div class="collapsediv" id="memcached_div">
            <div class="well on">
                <div class='alert alert-success' role='alert'>This service is enabled and bound to your app.  Use the connection info and code snippets below to use it in your app.</div>
            </div>
            <div class="well off">
                <div class="alert alert-warning" role="alert">This service was not provisioned during the microcloud creation process.  Create this service using the <a href="http://docs.hpcloud.com/#devplatform/1.3/helion/CLI/cfmgmt_growcluster_addservice.html">cf-mgmt tool</a>.</div>
                <p>To create an instance of the memecached service, execute the  commands below in the directory containing the your app:</p>
                <pre>helion
                    create-service memcached dotnet-starter-memcached dotnet-starter
                </pre>
                <p>You can also uncomment the following in the manifest.yml and push the app again.</p>
                <pre>
                    ${name}-memcached:<br />
                    &nbsp;&nbsp;type: memcached
                </pre>
                <p>After the steps above, deploy the app and refresh this page. </p>
                <pre>helion
                    push --stack win2012r2
                </pre>
            </div>
        </div>
        <div class="collapsediv" id="mongodb_div">
            <div class="well on">
                <div class='alert alert-success' role='alert'>This service is enabled and bound to your app.  Use the connection info and code snippets below to use it in your app.</div>
             </div>
            <div class="well off">
                <div class="alert alert-warning" role="alert">This service was not provisioned during the microcloud creation process.  Create this service using the <a href="http://docs.hpcloud.com/#devplatform/1.3/helion/CLI/cfmgmt_growcluster_addservice.html">cf-mgmt tool</a>.</div>
                <p>To create an instance of the mongo service, execute the  commands below in the directory containing the your app:</p>
                <pre>helion
                    create-service mongodb dotnet-starter-mongodb dotnet-starter
                </pre>
                <p>You can also uncomment the following in the manifest.yml and push the app again.</p>
                <pre>
                    ${name}-mongodb:<br />
                    &nbsp;&nbsp;type: mongodb
                </pre>
                <p>After the steps above, deploy the app and refresh this page. </p>
                <pre>helion
                    push --stack win2012r2
                </pre>
            </div>
        </div>
        <div class="collapsediv" id="mysql_div">
            <div class="well on">
                <div class='alert alert-success' role='alert'>This service is enabled and bound to your app.  Use the connection info and code snippets below to use it in your app.</div>
                <script type="syntaxhighlighter" class="brush: py">
                    <![CDATA[
                    import os
					import json;
					import MySQLdb
					import logging

					...

					log = logging.getLogger('mysql-test-code')
					log.setLevel(logging.DEBUG)

					VCAP_SERVICES = os.getenv("VCAP_SERVICES")

					vcap_json = json.loads(VCAP_SERVICES)
					mysql_service = vcap_json['mysql'][0]

					credentials = mysql_service['credentials']


					hostname = credentials['hostname']
					username = credentials['user']
					password = credentials['password']
					portNum = credentials['port']
					dbName = credentials['name']

					try:            
    					dbInstance = MySQLdb.connect(host=hostname,user=username,passwd=password,db=dbName, port=int(portNum)) 
    
					    testTableCreate = 'CREATE TABLE IF NOT EXISTS testtable( test_id int not null, test_value char(100),PRIMARY KEY(test_id));'
        
					    cur = dbInstance.cursor()
    					cur.execute(testTableCreate)
    					dbInstance.commit()
    
    					testTableInsert = "INSERT INTO testtable(test_id, test_value) values(1,'foo')";
    					cur = dbInstance.cursor()
    					cur.execute(testTableInsert)
    					dbInstance.commit()
					except MySQLdb.Error as e:
    					# handle failures here. 
    					log.error('failure: '+str(e))
					...
                    ]]>
                </script>
            </div>
            <div class="well off">
                <div class="alert alert-success" role="alert">This service was created during the microcloud creation process. The steps below will make it available for your app.</div>
                <p>To create an instance of the mysql service, execute the  commands below in the directory containing the your app:</p>
                <pre>helion
                    create-service mysql dotnet-starter-mysql dotnet-starter
                </pre>
                <p>You can also uncomment the following in the manifest.yml and push the app again.</p>
                <pre>
                    ${name}-mysql:<br />
                    &nbsp;&nbsp;type: mysql
                </pre>
                <p>After the steps above, deploy the app and refresh this page. </p>
                <pre>helion
                    push --stack win2012r2
                </pre>
            </div>
        </div>
        <div class="collapsediv" id="postgresql_div">
            <div class="well on">
                <div class='alert alert-success' role='alert'>This service is enabled and bound to your app.  Use the connection info and code snippets below to use it in your app.</div>
            </div>
            <div class="well off">
                <div class="alert alert-warning" role="alert">This service was not provisioned during the microcloud creation process.  Create this service using the <a href="http://docs.hpcloud.com/#devplatform/1.3/helion/CLI/cfmgmt_growcluster_addservice.html">cf-mgmt tool</a>.</div>
                <p>To create an instance of the postgres service, execute the  commands below in the directory containing the your app:</p>
                <pre>helion
                    create-service postgresql dotnet-starter-postgresql dotnet-starter
                </pre>
                <p>You can also uncomment the following in the manifest.yml and push the app again.</p>
                <pre>
                    ${name}-postgresql:<br />
                    &nbsp;&nbsp;type: postgresql
                </pre>
                <p>After the steps above, deploy the app and refresh this page. </p>
                <pre>helion
                    push --stack win2012r2
                </pre>
            </div>
        </div>
        <div class="collapsediv" id="rabbitmq3_div">
            <div class="well on">
                <div class='alert alert-success' role='alert'>This service is enabled and bound to your app.  Use the connection info and code snippets below to use it in your app.</div>
                <script type="syntaxhighlighter" class="brush: py">
                    <![CDATA[
					import os
					import json;	
					import logging
					import pika

					...

					VCAP_SERVICES = os.getenv("VCAP_SERVICES")

					vcap_json = json.loads(VCAP_SERVICES)
					rabbit_service = vcap_json['rabbitmq3'][0]

					credentials = rabbit_service['credentials']
    
					uri = credentials['uri']

					 
					try:
						# creating a queue
    					parameters = pika.URLParameters(uri)
    					connection = pika.BlockingConnection(parameters)
    					channel = connection.channel()
    					queueName = "testqueue"
    					channel.queue_declare(queue=queueName, durable=True)
    
    					# sending a message
    					channel.basic_publish(exchange='', routing_key=queueName, body="some text")
    					connection.close()
					except Exception as e:
    					log.error("error: "+str(e))

					try:
    					# getting a message 
    					parameters = pika.URLParameters(uri)
    					connection = pika.BlockingConnection(parameters)
    
    					channel = connection.channel()
    
    					method_frame, header_frame, body = channel.basic_get(queueName)
    					if method_frame:
        					channel.basic_ack(delivery_tag=method_frame.delivery_tag)
    					connection.close()
					except Exception as e:
    					log.error("error: "+str(e))
					
					...
					]]>
				</script>
            </div>
            <div class="well off">
                <div class="alert alert-warning" role="alert">This service was not provisioned during the microcloud creation process.  Create this service using the <a href="http://docs.hpcloud.com/#devplatform/1.3/helion/CLI/cfmgmt_growcluster_addservice.html">cf-mgmt tool</a>.</div>
                <p>To create an instance of the rabbit service, execute the  commands below in the directory containing the your app:</p>
                <pre>helion
                    create-service rabbitmq3 dotnet-starter-rabbitmq3 dotnet-starter
                </pre>
                <p>You can also uncomment the following in the manifest.yml and push the app again.</p>
                <pre>
                    ${name}-rabbitmq3:<br />
                    &nbsp;&nbsp;type: rabbitmq3
                </pre>
                <p>After the steps above, deploy the app and refresh this page. </p>
                <pre>helion
                    push --stack win2012r2
                </pre>
            </div>
        </div>
        <div class="collapsediv" id="mssql2014_div">
            <div class="well on">
                <div class='alert alert-success' role='alert'>This service is enabled and bound to your app.  Use the connection info and code snippets below to use it in your app.</div>
            </div>
            <div class="well off">
                <div class="alert alert-warning" role="alert">This service was not provisioned during the microcloud creation process.  Create this service using the <a href="http://docs.hpcloud.com/#devplatform/1.3/helion/CLI/cfmgmt_growcluster_addservice.html">cf-mgmt tool</a>.</div>
                <p>To create an instance of the sql server service, execute the  commands below in the directory containing the your app:</p>
                <pre>helion
                    create-service mssql2014 dotnet-starter-mssql2014 dotnet-starter
                </pre>
                <p>You can also uncomment the following in the manifest.yml and push the app again.</p>
                <pre>
                    ${name}-mssql2014:<br />
                    &nbsp;&nbsp;type: mssql2014
                </pre>
                <p>After the steps above, deploy the app and refresh this page. </p>
                <pre>helion
                    push --stack win2012r2
                </pre>
            </div>
        </div>
        <div class="collapsediv" id="redis_div">
            <div class="well on">
                <div class='alert alert-success' role='alert'>This service is enabled and bound to your app.  Use the connection info and code snippets below to use it in your app.</div>
            </div>
            <div class="well off">
                <div class="alert alert-warning" role="alert">This service was not provisioned during the microcloud creation process.  Create this service using the <a href="http://docs.hpcloud.com/#devplatform/1.3/helion/CLI/cfmgmt_growcluster_addservice.html">cf-mgmt tool</a>.</div>
                <p>To create an instance of the redis service, execute the  commands below in the directory containing the your app:</p>
                <pre>helion
                    create-service redis dotnet-starter-redis dotnet-starter
                </pre>
                <p>You can also uncomment the following in the manifest.yml and push the app again.</p>
                <pre>
                    ${name}-redis:<br />
                    &nbsp;&nbsp;type: redis
                </pre>
                <p>After the steps above, deploy the app and refresh this page. </p>
                <pre>helion
                    push --stack win2012r2
                </pre>
            </div>
        </div>
        <h2>User-Provided Services<span style="padding-left:10px;font-size:.6em">(these are externally provisioned and enabled)</span></h2>
        <div id="buttons">

        </div>
        <div id="found_userprovided_services">
            <div id="userprovided-service-buttons">

            </div>

                <div id='userprovided_divs'>
                    <div id="userprovided-services-howto_div" class="well off" style="display:none">
                        <div class="alert alert-warning" role="alert">
                            No <a href="http://docs.hpcloud.com/devplatform/1.2/helion/user/services/1.2user-provided.html">User Provided Services</a> have been created and bound to this app. Create and bind to one by following the steps below. 
                        </div>
                        <pre>helion create-service user-provided [name of service]</pre>
                        <p>The helion CLI will prompt you to specify credential keys and values (note defaults of hostname, port, password):</p>
                        <pre>Which credentials to use for connections [hostname, port, password]:</pre>
                        <p>
                            You can override these defaults with your own credential keys, separate keys with commas, and the CLI will then prompt you for values of each credential key.<br />
                            When you've created your service, you need to bind it to specific applications
                        </p>
                        <pre>helion bind-service [service name] [application name]</pre>
                    </div>


                </div>

        </div>

    </div>    
   

</body>
</html>